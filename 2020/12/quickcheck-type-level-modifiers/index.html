<!DOCTYPE html>
<html lang="en"><meta charset="utf-8"><meta name="generator" content="Hugo 0.89.2" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><title>Using QuickCheck&#39;s Positive Type Level Modifier&nbsp;&ndash;&nbsp;The Quiescent Current</title><link rel="stylesheet" href="/css/core.min.6794bc167e4ce0026d21831c61e605e88a70ef6cc11b090df06de3ed8be76f69afa57c9dcd7ba7210c777e124e943258.css" integrity="sha384-Z5S8Fn5M4AJtIYMcYeYF6Ipw72zBGwkN8G3j7Yvnb2mvpXydzXunIQx3fhJOlDJY"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Using QuickCheck&#39;s Positive Type Level Modifier" /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/"><span class="site name">The Quiescent Current</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/tags/">Tags</a><a class="nav item" href="/posts">Blog</a><a class="nav item" href="/series">Series</a><a class="nav item" href="/languages">Languages</a><a class="nav item" href="/about">About</a></nav></div></span></div><div class="site slogan"><span class="title">Go Far. Go Together.</span></div></section><section id="content"><div class="article-container"><section class="article header">
    <h1 class="article title">Using QuickCheck's Positive Type Level Modifier</h1><p class="article date">Thursday, December 24, 2020</p></section><article class="article markdown-body"><p>One of my students this semester was struggling with the material. This
student is a very diligent worker and has been researching the problems trying
to get a better understanding of the material before digging in. Sometimes
however, there is no replacement for just digging in and coding something.
This does at least two things, it solidifies the material you&rsquo;re read so far,
and most importantly it shows you the limits of what you currently understand
and urges you to learn more. Interestingly, I&rsquo;ve found in my own intellectual
endeavors some things just don&rsquo;t make any sense until you&rsquo;ve tried to use it
<em>in anger</em>.</p>
<hr>
<p>I gave this student the advice to</p>
<blockquote>
<p>Put down the books.
Pick up a pencil, some paper and a compiler
Code it. Make your brain hurt.</p>
</blockquote>
<p>As I was sharing this I realized how hypocritical I was. I&rsquo;ve <em>been
learning</em> Haskell, and yet I haven&rsquo;t coded in Haskell in over a year. I&rsquo;ve
been reading books, watching videos.</p>
<blockquote>
<p>I&rsquo;ve been a Spectator.
It&rsquo;s time to be a Doer.</p>
</blockquote>
<p>I started working through the codewars.com problems, specifically working on
the test cases for this <a href="https://www.codewars.com/kata/576757b1df89ecf5bd00073b/train/haskell"target="_blank" rel="noopener noreferrer">problem</a>
.</p>
<p>While coding the QuickCheck properties (tests) for this problem however, I was
completely lost at trying to build a property with only positive generator
values.</p>
<p>This particular test is trying to show that the height of the pyramid is the
length of the out put array/list.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-haskell" data-lang="haskell"><span class="nf">prop_heightIsLength</span> <span class="ow">::</span> <span class="kt">Int</span> <span class="ow">-&gt;</span>  <span class="kt">Bool</span>
<span class="nf">prop_heightIsLength</span> <span class="n">height</span> <span class="ow">=</span> <span class="n">length</span> <span class="p">(</span> <span class="n">buildTower</span> <span class="n">height</span> <span class="p">)</span> <span class="o">==</span> <span class="n">height</span>
</code></pre></div><p>However, <code>buildTower</code> only defined for positive values. My first pass of
the property is generates negative values (and 0 values) as input. After some
searching I was able to find the Positive type modifier for quickcheck.</p>
<p><a href="https://hackage.haskell.org/package/QuickCheck-2.4.1.1/docs/Test-QuickCheck.html#t:Positive"target="_blank" rel="noopener noreferrer">https://hackage.haskell.org/package/QuickCheck-2.4.1.1/docs/Test-QuickCheck.html#t:Positive</a>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-haskell" data-lang="haskell"><span class="nf">prop_heightIsLength</span> <span class="ow">::</span> <span class="kt">Positive</span> <span class="kt">Int</span> <span class="ow">-&gt;</span>  <span class="kt">Bool</span>
<span class="nf">prop_heightIsLength</span> <span class="n">height</span> <span class="ow">=</span> <span class="n">length</span> <span class="p">(</span> <span class="n">buildTower</span> <span class="n">height</span> <span class="p">)</span> <span class="o">==</span> <span class="n">height</span>
</code></pre></div><p>However, this doesn&rsquo;t compile.</p>
<pre tabindex="0"><code>Couldn't match expected type ‘Positive Int’
                  with actual type ‘Int’
</code></pre><p>Which brings me to my biggest challenge in learning anything new. Frequently
in learning something new I don&rsquo;t have enough knowledge to ask the right
question, or even understand the answer. This is one of those cases.</p>
<h2 id="failed-questions">Failed Questions</h2>
<ol>
<li>haskell unwrap Positive newtype</li>
<li>haskell use QuickCheck Positive</li>
<li>haskell constraint quickcheck generator</li>
</ol>
<p>This lead me to the closest answer</p>
<p><a href="https://stackoverflow.com/questions/11910143/positive-integer-type#11910221"target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/11910143/positive-integer-type#11910221</a>
</p>
<p>However, it is demonstrating how to build a custom generator. I just want to
use the built in constraints!</p>
<blockquote>
<p>Why is this so hard?
Because I didn&rsquo;t know how to read the type signature of the Postive type.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-haskell" data-lang="haskell"><span class="c1">-- This property does not compile</span>
<span class="nf">prop_heightIsLength</span> <span class="ow">::</span> <span class="kt">Positive</span> <span class="kt">Int</span> <span class="ow">-&gt;</span>  <span class="kt">Bool</span>
<span class="nf">prop_heightIsLength</span> <span class="n">height</span> <span class="ow">=</span> <span class="n">length</span> <span class="p">(</span> <span class="n">buildTower</span> <span class="n">height</span> <span class="p">)</span> <span class="o">==</span> <span class="n">height</span>


<span class="c1">-- This property compiles</span>
<span class="nf">prop_heightIsLength&#39;</span> <span class="ow">::</span> <span class="kt">Positive</span> <span class="kt">Int</span> <span class="ow">-&gt;</span>  <span class="kt">Bool</span>
<span class="nf">prop_heightIsLength&#39;</span> <span class="p">(</span><span class="kt">Positive</span> <span class="n">height</span><span class="p">)</span> <span class="ow">=</span> <span class="n">length</span> <span class="p">(</span> <span class="n">buildTower</span> <span class="n">height</span> <span class="p">)</span> <span class="o">==</span> <span class="n">height</span>
</code></pre></div><p>Naively, I thought the different is the parenthesis. Remember, parenthesis are
<em>only used for grouping</em> in haskell. They have no other purpose. The different
is <em>what is bound to the name <code>height</code></em>. In the first version, I&rsquo;m binding
a <code>Positive Int</code> to the name <code>height</code> in the second version I&rsquo;m
binding merely an <code>Int</code> to <code>height</code>. The Positive type modifier
assures that the values bound to it&rsquo;s parameter are always positive. The bound
value however will retain the <code>Int</code> type, even though it&rsquo;s value is always
positive.</p>
<p>I&rsquo;m unstuck now. Moving on.</p>
</article><section class="article labels"><a class="tag" href=/tags/quickcheck/>QuickCheck</a><a class="tag" href=/tags/im-stuck/>I&#39;m Stuck</a></section><div class="article share addthis_inline_share_toolbox"></div><script defer src="/js/addthis_widget.min.99872df1091f055fca553e0b74b13c09bd383ef42b1c56a9edb651a91f122d56e7bc9a2fad73528246215b379b043226.js#pubid=ra-1234567890" integrity="sha384-mYct8QkfBV/KVT4LdLE8Cb04PvQrHFap7bZRqR8SLVbnvJovrXNSgkYhWzebBDIm"></script>
</div>
<div class="article bottom"><section class="article navigation"><p><a class="link" href="/2021/03/not-incremental/"><span class="iconfont icon-article"></span>The World Is Not Incremental</a></p><p><a class="link" href="/2020/05/learning-process/"><span class="iconfont icon-article"></span>My Learning Process</a></p></section><section class="article discussion"><div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "codestrokes2" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">©2021 Jeremy Wright</p>
    <p class="powerby"><span>Powered&nbsp;by&nbsp;</span><a href="https://gohugo.io" 
        target="_blank" rel="noopener noreferrer">Hugo</a><span>&nbsp;&amp;&nbsp;</span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank" rel="noopener noreferrer">Notepadium</a></p></div>
</section><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/&#43;DiW/UqRcLbRjq" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l&#43;B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd&#43;qj&#43;o24G5ZU2zJz" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
            onload="renderMathInElement(document.body);"></script></body>

</html>